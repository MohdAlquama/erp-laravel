import{r as t,j as e}from"./app-Wa6lWOWG.js";import{A as M}from"./AdminLayout-YyFShQkb.js";import{u as B}from"./adminContext-B60SD0yp.js";import{a as o}from"./axiosInstance-s0tKBack.js";import{V as s}from"./index-FiFwkoWx.js";import{L as F}from"./Loader-x6iW4oYD.js";import{P as $}from"./plus-CD3ODjQu.js";import{P as q}from"./pencil-BoOtjXia.js";import{T as I}from"./trash-DlPpJoje.js";import"./menu-BHFqgBA3.js";import"./createLucideIcon-B9bo5B-_.js";import"./search-CzDEQAMp.js";import"./bell-ltEBjq8P.js";import"./user-Cl31KUXQ.js";import"./x-B9DMul12.js";import"./house-BKnVdLgc.js";import"./users-DgKBGHnW.js";import"./settings-CqOTu34U.js";import"./log-out-CShTseuz.js";import"./loader-circle-Bzqp0nAN.js";function U(){const{admin:c,permissions:x}=B(),[j,N]=t.useState([]),[k,v]=t.useState([]),[r,m]=t.useState({name:"",email:"",password:"",batch_ids:[]}),[d,g]=t.useState(null),[b,C]=t.useState(""),[S,h]=t.useState(!1),[T,f]=t.useState(!0),i=a=>x==null?void 0:x.includes(a);t.useEffect(()=>{p(),E()},[]);const p=async()=>{f(!0);try{const a=await o.get(`/admin/${c.id}/teachers`);N(a.data)}catch{s.error("Failed to fetch teachers")}finally{f(!1)}},E=async()=>{try{const a=await o.get(`/admin/${c.id}/batches`);v(a.data)}catch{s.error("Failed to fetch batches")}},y=()=>{m({name:"",email:"",password:"",batch_ids:[]}),g(null)},u=a=>{m({...r,[a.target.name]:a.target.value})},A=a=>{const n=a.target.value;m(l=>({...l,batch_ids:a.target.checked?[...l.batch_ids,n]:l.batch_ids.filter(L=>L!==n)}))},D=async a=>{if(a.preventDefault(),!i(d?"TeacherManagementEdit":"TeacherManagementAdd"))return s.error("Permission denied");if(!d&&!r.password)return s.error("Password is required");const l={...r,created_by:c.id};try{d?(delete l.password,await o.put(`/admin/teachers/${d}`,l),s.success("Updated successfully")):(await o.post("/admin/t","c c"),console.log("fbfbdf"),s.success("Added successfully")),p(),y(),h(!1)}catch{s.error("Something went wrong")}},P=a=>{m({name:a.name,email:a.email,password:"",batch_ids:a.batches.map(n=>n.id.toString())}),g(a.id),h(!0)},_=async a=>{if(!i("TeacherManagementDelete"))return s.error("Permission denied");if(window.confirm("Delete teacher?"))try{await o.delete(`/admin/teachers/${a}`),p(),s.success("Deleted")}catch{s.error("Failed to delete")}},w=j.filter(a=>a.name.toLowerCase().includes(b.toLowerCase()));return e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Teachers"}),i("TeacherManagementAdd")&&e.jsxs("button",{onClick:()=>h(!0),className:"bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"})," Add Teacher"]})]}),e.jsx("input",{type:"text",placeholder:"Search...",value:b,onChange:a=>C(a.target.value),className:"mb-4 px-4 py-2 border rounded w-full md:w-1/3 dark:bg-gray-800"}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-x-auto",children:T?e.jsx("div",{className:"p-6",children:e.jsx(F,{message:"Loading teachers..."})}):e.jsxs("table",{className:"min-w-full text-sm text-left text-gray-800 dark:text-white",children:[e.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700 text-xs uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"Name"}),e.jsx("th",{className:"px-4 py-2",children:"Email"}),e.jsx("th",{className:"px-4 py-2",children:"Batches"}),e.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:w.length>0?w.map(a=>e.jsxs("tr",{className:"border-b dark:border-gray-600",children:[e.jsx("td",{className:"px-4 py-2",children:a.name}),e.jsx("td",{className:"px-4 py-2 break-all",children:a.email}),e.jsx("td",{className:"px-4 py-2 break-all",children:a.batches.map(n=>n.name).join(", ")}),e.jsxs("td",{className:"px-4 py-2 flex gap-2",children:[i("TeacherManagementEdit")&&e.jsxs("button",{onClick:()=>P(a),className:"text-yellow-600 hover:underline",children:[e.jsx(q,{className:"w-4 h-4 inline"})," Edit"]}),i("TeacherManagementDelete")&&e.jsxs("button",{onClick:()=>_(a.id),className:"text-red-600 hover:underline",children:[e.jsx(I,{className:"w-4 h-4 inline"})," Delete"]})]})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center text-gray-500 dark:text-gray-400 p-4",children:"No teachers found"})})})]})}),e.jsxs("div",{className:`fixed top-0 right-0 h-full w-full sm:w-[400px] bg-white dark:bg-gray-900 transition-transform shadow-lg z-50 ${S?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-bold",children:d?"Edit Teacher":"Add Teacher"}),e.jsx("button",{onClick:()=>{y(),h(!1)},className:"text-gray-600 dark:text-gray-300 hover:text-red-600",children:"âœ•"})]}),e.jsxs("form",{onSubmit:D,className:"p-4 space-y-4",children:[e.jsx("input",{type:"text",name:"name",value:r.name,onChange:u,placeholder:"Name",required:!0,className:"w-full px-4 py-2 border rounded dark:bg-gray-800"}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:u,placeholder:"Email",required:!0,className:"w-full px-4 py-2 border rounded dark:bg-gray-800"}),!d&&e.jsx("input",{type:"password",name:"password",value:r.password,onChange:u,placeholder:"Password",required:!0,className:"w-full px-4 py-2 border rounded dark:bg-gray-800"}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Assign Batches"}),e.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-40 overflow-y-auto border rounded p-2 dark:bg-gray-800",children:k.map(a=>e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",value:a.id,checked:r.batch_ids.includes(a.id.toString()),onChange:A,className:"accent-indigo-600"}),e.jsx("span",{children:a.name})]},a.id))})]}),e.jsx("button",{type:"submit",className:"bg-indigo-600 text-white w-full py-2 rounded hover:bg-indigo-700",children:d?"Update":"Create"})]})]})]})}U.layout=c=>e.jsx(M,{children:c});export{U as default};
